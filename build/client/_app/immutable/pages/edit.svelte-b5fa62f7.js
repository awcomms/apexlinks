import{S as re,i as le,s as oe,C as J,w as v,x as w,y as k,z as ue,A as me,q as d,o as b,B as E,K as y,r as ce,L as pe,V as K,M as _e,O as ge,P as de,Q as be,W as S,_ as U,k as B,e as G,m as F,c as H,g as T,T as ae,Y as j,d as h,Z as he,a1 as ve,t as fe,a as M,h as ie,H as A,J as we,b as ke,N as x,R as ee,n as Ee,p as Te}from"../chunks/index-e47b4649.js";import{a as te}from"../chunks/socket-359f452a.js";import{r as Ce}from"../chunks/routes-fb6e9fa0.js";import{g as Ie}from"../chunks/navigation-0e6511d1.js";import"../chunks/HeaderSearch.svelte_svelte_type_style_lang-dee62dc9.js";import{B as Be}from"../chunks/Button-bbcf2e94.js";import{T as Fe,C as Re}from"../chunks/Tags-072a8ed0.js";import{F as Ge,I as He}from"../chunks/Input-53fbfba2.js";import{R as L}from"../chunks/Row-c4df0ce6.js";import{C as z}from"../chunks/Column-5e525297.js";import{I as Pe}from"../chunks/InlineLoading-d1ee122e.js";import{s as ne}from"../chunks/stores-4f4e660a.js";import"../chunks/singletons-d1fb5791.js";import"../chunks/index-8107d937.js";import"../chunks/Tag-473639f3.js";import"../chunks/Close-b8ee64fe.js";/* empty css                                                   */import"../chunks/TextInput-439d1c85.js";import"../chunks/Loading-1a7be6da.js";function Ve(o){let e;const n=o[1].default,t=_e(n,o,o[8],null);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,r){t&&t.m(s,r),e=!0},p(s,r){t&&t.p&&(!e||r&256)&&ge(t,n,s,s[8],e?be(n,s[8],r,null):de(s[8]),null)},i(s){e||(d(t,s),e=!0)},o(s){b(t,s),e=!1},d(s){t&&t.d(s)}}}function qe(o){let e,n;const t=[o[0],{class:"bx--form--fluid "+o[0].class}];let s={$$slots:{default:[Ve]},$$scope:{ctx:o}};for(let r=0;r<t.length;r+=1)s=J(s,t[r]);return e=new Ge({props:s}),e.$on("click",o[2]),e.$on("keydown",o[3]),e.$on("mouseover",o[4]),e.$on("mouseenter",o[5]),e.$on("mouseleave",o[6]),e.$on("submit",o[7]),{c(){v(e.$$.fragment)},l(r){w(e.$$.fragment,r)},m(r,a){k(e,r,a),n=!0},p(r,[a]){const c=a&1?ue(t,[me(r[0]),{class:"bx--form--fluid "+r[0].class}]):{};a&256&&(c.$$scope={dirty:a,ctx:r}),e.$set(c)},i(r){n||(d(e.$$.fragment,r),n=!0)},o(r){b(e.$$.fragment,r),n=!1},d(r){E(e,r)}}}function De(o,e,n){const t=[];let s=y(e,t),{$$slots:r={},$$scope:a}=e;ce("Form",{isFluid:!0});function c(m){K.call(this,o,m)}function f(m){K.call(this,o,m)}function g(m){K.call(this,o,m)}function u(m){K.call(this,o,m)}function i(m){K.call(this,o,m)}function _(m){K.call(this,o,m)}return o.$$set=m=>{e=J(J({},e),pe(m)),n(0,s=y(e,t)),"$$scope"in m&&n(8,a=m.$$scope)},[s,r,c,f,g,u,i,_,a]}class Ke extends re{constructor(e){super(),le(this,e,De,qe,oe,{})}}function Le(o){let e,n;return{c(){e=G("h1"),n=fe("Edit your profile")},l(t){e=H(t,"H1",{});var s=M(e);n=ie(s,"Edit your profile"),s.forEach(h)},m(t,s){T(t,e,s),A(e,n)},p:we,d(t){t&&h(e)}}}function Se(o){let e,n;return e=new z({props:{$$slots:{default:[Le]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,s){k(e,t,s),n=!0},p(t,s){const r={};s&131072&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function Ue(o){let e,n,t;function s(a){o[9](a)}let r={labelText:"Hide profile from public"};return o[1]!==void 0&&(r.checked=o[1]),e=new Re({props:r}),S.push(()=>U(e,"checked",s)),e.$on("change",o[7]),{c(){v(e.$$.fragment)},l(a){w(e.$$.fragment,a)},m(a,c){k(e,a,c),t=!0},p(a,c){const f={};!n&&c&2&&(n=!0,f.checked=a[1],j(()=>n=!1)),e.$set(f)},i(a){t||(d(e.$$.fragment,a),t=!0)},o(a){b(e.$$.fragment,a),t=!1},d(a){E(e,a)}}}function je(o){let e,n;return e=new z({props:{$$slots:{default:[Ue]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,s){k(e,t,s),n=!0},p(t,s){const r={};s&131074&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function ze(o){let e,n,t,s,r;function a(u){o[11](u)}function c(u){o[12](u)}function f(u){o[13](u)}let g={labelText:"Username"};return o[4]!==void 0&&(g.invalidText=o[4]),o[3]!==void 0&&(g.invalid=o[3]),o[0]!==void 0&&(g.value=o[0]),e=new He({props:g}),S.push(()=>U(e,"invalidText",a)),S.push(()=>U(e,"invalid",c)),S.push(()=>U(e,"value",f)),{c(){v(e.$$.fragment)},l(u){w(e.$$.fragment,u)},m(u,i){k(e,u,i),r=!0},p(u,i){const _={};!n&&i&16&&(n=!0,_.invalidText=u[4],j(()=>n=!1)),!t&&i&8&&(t=!0,_.invalid=u[3],j(()=>t=!1)),!s&&i&1&&(s=!0,_.value=u[0],j(()=>s=!1)),e.$set(_)},i(u){r||(d(e.$$.fragment,u),r=!0)},o(u){b(e.$$.fragment,u),r=!1},d(u){E(e,u)}}}function Ae(o){let e,n;return e=new Ke({props:{$$slots:{default:[ze]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,s){k(e,t,s),n=!0},p(t,s){const r={};s&131097&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function Je(o){let e,n;return e=new z({props:{$$slots:{default:[Ae]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,s){k(e,t,s),n=!0},p(t,s){const r={};s&131097&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function Me(o){let e,n;return e=new z({}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,s){k(e,t,s),n=!0},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function se(o){let e,n,t;return n=new Pe({}),{c(){e=G("div"),v(n.$$.fragment),this.h()},l(s){e=H(s,"DIV",{class:!0});var r=M(e);w(n.$$.fragment,r),r.forEach(h),this.h()},h(){ke(e,"class","right svelte-1ensibi")},m(s,r){T(s,e,r),k(n,e,null),t=!0},i(s){t||(d(n.$$.fragment,s),t=!0)},o(s){b(n.$$.fragment,s),t=!1},d(s){s&&h(e),E(n)}}}function Ne(o){let e,n,t,s,r,a,c,f=o[5]&&se(),g=[o[16]],u={};for(let i=0;i<g.length;i+=1)u=J(u,g[i]);return{c(){e=G("div"),n=G("p"),t=fe("Edit"),s=B(),f&&f.c(),this.h()},l(i){e=H(i,"DIV",{});var _=M(e);n=H(_,"P",{});var m=M(n);t=ie(m,"Edit"),m.forEach(h),s=F(_),f&&f.l(_),_.forEach(h),this.h()},h(){x(e,u),ee(e,"svelte-1ensibi",!0)},m(i,_){T(i,e,_),A(e,n),A(n,t),A(e,s),f&&f.m(e,null),r=!0,a||(c=ae(e,"click",o[7]),a=!0)},p(i,_){i[5]?f?_&32&&d(f,1):(f=se(),f.c(),d(f,1),f.m(e,null)):f&&(Ee(),b(f,1,1,()=>{f=null}),Te()),x(e,u=ue(g,[_&65536&&i[16]])),ee(e,"svelte-1ensibi",!0)},i(i){r||(d(f),r=!0)},o(i){b(f),r=!1},d(i){i&&h(e),f&&f.d(),a=!1,c()}}}function Oe(o){let e,n;return e=new Be({props:{as:!0,$$slots:{default:[Ne,({props:t})=>({16:t}),({props:t})=>t?65536:0]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,s){k(e,t,s),n=!0},p(t,s){const r={};s&196640&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function Qe(o){let e,n;return e=new z({props:{$$slots:{default:[Oe]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,s){k(e,t,s),n=!0},p(t,s){const r={};s&131104&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function We(o){let e,n,t,s,r,a,c,f,g,u,i,_,m,C,P,V,q,I,p,R,D;e=new L({props:{noGutter:!0,$$slots:{default:[Se]},$$scope:{ctx:o}}}),r=new L({props:{noGutter:!0,$$slots:{default:[je]},$$scope:{ctx:o}}});function $e(l){o[10](l)}let N={hidable:!0};return o[2]!==void 0&&(N.tags=o[2]),c=new Fe({props:N}),S.push(()=>U(c,"tags",$e)),u=new L({props:{noGutter:!0,$$slots:{default:[Je]},$$scope:{ctx:o}}}),C=new L({props:{noGutter:!0,$$slots:{default:[Me]},$$scope:{ctx:o}}}),I=new L({props:{noGutter:!0,$$slots:{default:[Qe]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment),n=B(),t=G("br"),s=B(),v(r.$$.fragment),a=B(),v(c.$$.fragment),g=B(),v(u.$$.fragment),i=B(),_=G("br"),m=B(),v(C.$$.fragment),P=B(),V=G("br"),q=B(),v(I.$$.fragment)},l(l){w(e.$$.fragment,l),n=F(l),t=H(l,"BR",{}),s=F(l),w(r.$$.fragment,l),a=F(l),w(c.$$.fragment,l),g=F(l),w(u.$$.fragment,l),i=F(l),_=H(l,"BR",{}),m=F(l),w(C.$$.fragment,l),P=F(l),V=H(l,"BR",{}),q=F(l),w(I.$$.fragment,l)},m(l,$){k(e,l,$),T(l,n,$),T(l,t,$),T(l,s,$),k(r,l,$),T(l,a,$),k(c,l,$),T(l,g,$),k(u,l,$),T(l,i,$),T(l,_,$),T(l,m,$),k(C,l,$),T(l,P,$),T(l,V,$),T(l,q,$),k(I,l,$),p=!0,R||(D=ae(window,"keydown",o[6]),R=!0)},p(l,[$]){const O={};$&131072&&(O.$$scope={dirty:$,ctx:l}),e.$set(O);const Q={};$&131074&&(Q.$$scope={dirty:$,ctx:l}),r.$set(Q);const W={};!f&&$&4&&(f=!0,W.tags=l[2],j(()=>f=!1)),c.$set(W);const Y={};$&131097&&(Y.$$scope={dirty:$,ctx:l}),u.$set(Y);const Z={};$&131072&&(Z.$$scope={dirty:$,ctx:l}),C.$set(Z);const X={};$&131104&&(X.$$scope={dirty:$,ctx:l}),I.$set(X)},i(l){p||(d(e.$$.fragment,l),d(r.$$.fragment,l),d(c.$$.fragment,l),d(u.$$.fragment,l),d(C.$$.fragment,l),d(I.$$.fragment,l),p=!0)},o(l){b(e.$$.fragment,l),b(r.$$.fragment,l),b(c.$$.fragment,l),b(u.$$.fragment,l),b(C.$$.fragment,l),b(I.$$.fragment,l),p=!1},d(l){E(e,l),l&&h(n),l&&h(t),l&&h(s),E(r,l),l&&h(a),E(c,l),l&&h(g),E(u,l),l&&h(i),l&&h(_),l&&h(m),E(C,l),l&&h(P),l&&h(V),l&&h(q),E(I,l),R=!1,D()}}}const _t=async({session:o})=>{let e=o.user;return e?{props:{user:e}}:{status:302,redirect:Ce.login}};function Ye(o,e,n){let t;he(o,ne,p=>n(14,t=p));let{user:s}=e,r=s.username,a=s.hidden,c=s.image,f=s.tags||[],g,u,i;const _=p=>{switch(p.keyCode){case 13:p.ctrlKey&&m()}},m=async()=>{if(n(5,i=!0),!r){n(3,g=!0),n(4,u="Empty"),n(5,i=!1);return}if(r!==s.username&&await te.get(`check_username/${r}`).then(D=>!D.res)){n(3,g=!0),n(4,u="Username taken"),n(5,i=!1);return}let p={username:r,hidden:a,image:c,tags:f},R=await te.put("users",p).finally(D=>(n(5,i=!1),D));R.id&&(ve(ne,t.user=R,t),Ie(`/u/${R.id}`))};function C(p){a=p,n(1,a)}function P(p){f=p,n(2,f)}function V(p){u=p,n(4,u)}function q(p){g=p,n(3,g)}function I(p){r=p,n(0,r)}return o.$$set=p=>{"user"in p&&n(8,s=p.user)},[r,a,f,g,u,i,_,m,s,C,P,V,q,I]}class gt extends re{constructor(e){super(),le(this,e,Ye,We,oe,{user:8})}}export{gt as default,_t as load};
