import{S as se,i as le,s as oe,C as M,w as v,x as w,y as k,z as ue,A as me,q as d,o as b,B as E,M as y,r as ce,N as pe,W as H,O as _e,Q as ge,R as de,T as be,X as S,$ as j,k as B,e as G,m as F,c as P,g as T,V as ae,Z as z,d as h,_ as he,a2 as ve,t as fe,a as N,h as ie,K as L,E as we,b as ke,P as x,U as ee,n as Ee,p as Te}from"../chunks/index-3c306420.js";import{a as te}from"../chunks/socket-359f452a.js";import{r as Ce}from"../chunks/routes-fb6e9fa0.js";import{g as Ie}from"../chunks/navigation-0e6511d1.js";import"../chunks/HeaderSearch.svelte_svelte_type_style_lang-47ee749e.js";import{B as Be}from"../chunks/Button-c662ee71.js";import{T as Fe,C as Re}from"../chunks/Tags-ad6072fd.js";import{F as Ge,I as Pe}from"../chunks/Input-4178a5d7.js";import{R as K}from"../chunks/Row-ee11b4a3.js";import{C as A}from"../chunks/Column-0c866349.js";import{I as Ue}from"../chunks/InlineLoading-b83e13ec.js";import{s as ne}from"../chunks/stores-60fbd2b2.js";import"../chunks/singletons-d1fb5791.js";import"../chunks/index-b8508cdc.js";import"../chunks/index-7392e856.js";import"../chunks/Tag-136bef5b.js";import"../chunks/Close-7302402c.js";/* empty css                                                   */import"../chunks/TextInput-78434c7c.js";import"../chunks/Loading-b4bca80f.js";function Ve(o){let e;const n=o[1].default,t=_e(n,o,o[8],null);return{c(){t&&t.c()},l(r){t&&t.l(r)},m(r,s){t&&t.m(r,s),e=!0},p(r,s){t&&t.p&&(!e||s&256)&&ge(t,n,r,r[8],e?be(n,r[8],s,null):de(r[8]),null)},i(r){e||(d(t,r),e=!0)},o(r){b(t,r),e=!1},d(r){t&&t.d(r)}}}function qe(o){let e,n;const t=[o[0],{class:"bx--form--fluid "+o[0].class}];let r={$$slots:{default:[Ve]},$$scope:{ctx:o}};for(let s=0;s<t.length;s+=1)r=M(r,t[s]);return e=new Ge({props:r}),e.$on("click",o[2]),e.$on("keydown",o[3]),e.$on("mouseover",o[4]),e.$on("mouseenter",o[5]),e.$on("mouseleave",o[6]),e.$on("submit",o[7]),{c(){v(e.$$.fragment)},l(s){w(e.$$.fragment,s)},m(s,a){k(e,s,a),n=!0},p(s,[a]){const c=a&1?ue(t,[me(s[0]),{class:"bx--form--fluid "+s[0].class}]):{};a&256&&(c.$$scope={dirty:a,ctx:s}),e.$set(c)},i(s){n||(d(e.$$.fragment,s),n=!0)},o(s){b(e.$$.fragment,s),n=!1},d(s){E(e,s)}}}function De(o,e,n){const t=[];let r=y(e,t),{$$slots:s={},$$scope:a}=e;ce("Form",{isFluid:!0});function c(m){H.call(this,o,m)}function f(m){H.call(this,o,m)}function g(m){H.call(this,o,m)}function u(m){H.call(this,o,m)}function i(m){H.call(this,o,m)}function _(m){H.call(this,o,m)}return o.$$set=m=>{e=M(M({},e),pe(m)),n(0,r=y(e,t)),"$$scope"in m&&n(8,a=m.$$scope)},[r,s,c,f,g,u,i,_,a]}class He extends se{constructor(e){super(),le(this,e,De,qe,oe,{})}}function Ke(o){let e,n;return{c(){e=G("h1"),n=fe("Edit your profile")},l(t){e=P(t,"H1",{});var r=N(e);n=ie(r,"Edit your profile"),r.forEach(h)},m(t,r){T(t,e,r),L(e,n)},p:we,d(t){t&&h(e)}}}function Se(o){let e,n;return e=new A({props:{$$slots:{default:[Ke]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,r){k(e,t,r),n=!0},p(t,r){const s={};r&131072&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function je(o){let e,n,t;function r(a){o[9](a)}let s={labelText:"Hide profile from public"};return o[1]!==void 0&&(s.checked=o[1]),e=new Re({props:s}),S.push(()=>j(e,"checked",r)),e.$on("change",o[7]),{c(){v(e.$$.fragment)},l(a){w(e.$$.fragment,a)},m(a,c){k(e,a,c),t=!0},p(a,c){const f={};!n&&c&2&&(n=!0,f.checked=a[1],z(()=>n=!1)),e.$set(f)},i(a){t||(d(e.$$.fragment,a),t=!0)},o(a){b(e.$$.fragment,a),t=!1},d(a){E(e,a)}}}function ze(o){let e,n;return e=new A({props:{$$slots:{default:[je]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,r){k(e,t,r),n=!0},p(t,r){const s={};r&131074&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function Ae(o){let e,n,t,r,s;function a(u){o[11](u)}function c(u){o[12](u)}function f(u){o[13](u)}let g={labelText:"Username"};return o[4]!==void 0&&(g.invalidText=o[4]),o[3]!==void 0&&(g.invalid=o[3]),o[0]!==void 0&&(g.value=o[0]),e=new Pe({props:g}),S.push(()=>j(e,"invalidText",a)),S.push(()=>j(e,"invalid",c)),S.push(()=>j(e,"value",f)),{c(){v(e.$$.fragment)},l(u){w(e.$$.fragment,u)},m(u,i){k(e,u,i),s=!0},p(u,i){const _={};!n&&i&16&&(n=!0,_.invalidText=u[4],z(()=>n=!1)),!t&&i&8&&(t=!0,_.invalid=u[3],z(()=>t=!1)),!r&&i&1&&(r=!0,_.value=u[0],z(()=>r=!1)),e.$set(_)},i(u){s||(d(e.$$.fragment,u),s=!0)},o(u){b(e.$$.fragment,u),s=!1},d(u){E(e,u)}}}function Le(o){let e,n;return e=new He({props:{$$slots:{default:[Ae]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,r){k(e,t,r),n=!0},p(t,r){const s={};r&131097&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function Me(o){let e,n;return e=new A({props:{$$slots:{default:[Le]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,r){k(e,t,r),n=!0},p(t,r){const s={};r&131097&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function Ne(o){let e,n;return e=new A({}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,r){k(e,t,r),n=!0},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function re(o){let e,n,t;return n=new Ue({}),{c(){e=G("div"),v(n.$$.fragment),this.h()},l(r){e=P(r,"DIV",{class:!0});var s=N(e);w(n.$$.fragment,s),s.forEach(h),this.h()},h(){ke(e,"class","right svelte-1ensibi")},m(r,s){T(r,e,s),k(n,e,null),t=!0},i(r){t||(d(n.$$.fragment,r),t=!0)},o(r){b(n.$$.fragment,r),t=!1},d(r){r&&h(e),E(n)}}}function Oe(o){let e,n,t,r,s,a,c,f=o[5]&&re(),g=[o[16]],u={};for(let i=0;i<g.length;i+=1)u=M(u,g[i]);return{c(){e=G("div"),n=G("p"),t=fe("Edit"),r=B(),f&&f.c(),this.h()},l(i){e=P(i,"DIV",{});var _=N(e);n=P(_,"P",{});var m=N(n);t=ie(m,"Edit"),m.forEach(h),r=F(_),f&&f.l(_),_.forEach(h),this.h()},h(){x(e,u),ee(e,"svelte-1ensibi",!0)},m(i,_){T(i,e,_),L(e,n),L(n,t),L(e,r),f&&f.m(e,null),s=!0,a||(c=ae(e,"click",o[7]),a=!0)},p(i,_){i[5]?f?_&32&&d(f,1):(f=re(),f.c(),d(f,1),f.m(e,null)):f&&(Ee(),b(f,1,1,()=>{f=null}),Te()),x(e,u=ue(g,[_&65536&&i[16]])),ee(e,"svelte-1ensibi",!0)},i(i){s||(d(f),s=!0)},o(i){b(f),s=!1},d(i){i&&h(e),f&&f.d(),a=!1,c()}}}function Qe(o){let e,n;return e=new Be({props:{as:!0,$$slots:{default:[Oe,({props:t})=>({16:t}),({props:t})=>t?65536:0]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,r){k(e,t,r),n=!0},p(t,r){const s={};r&196640&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function We(o){let e,n;return e=new A({props:{$$slots:{default:[Qe]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,r){k(e,t,r),n=!0},p(t,r){const s={};r&131104&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function Xe(o){let e,n,t,r,s,a,c,f,g,u,i,_,m,C,U,V,q,I,p,R,D;e=new K({props:{noGutter:!0,$$slots:{default:[Se]},$$scope:{ctx:o}}}),s=new K({props:{noGutter:!0,$$slots:{default:[ze]},$$scope:{ctx:o}}});function $e(l){o[10](l)}let O={hidable:!0};return o[2]!==void 0&&(O.tags=o[2]),c=new Fe({props:O}),S.push(()=>j(c,"tags",$e)),u=new K({props:{noGutter:!0,$$slots:{default:[Me]},$$scope:{ctx:o}}}),C=new K({props:{noGutter:!0,$$slots:{default:[Ne]},$$scope:{ctx:o}}}),I=new K({props:{noGutter:!0,$$slots:{default:[We]},$$scope:{ctx:o}}}),{c(){v(e.$$.fragment),n=B(),t=G("br"),r=B(),v(s.$$.fragment),a=B(),v(c.$$.fragment),g=B(),v(u.$$.fragment),i=B(),_=G("br"),m=B(),v(C.$$.fragment),U=B(),V=G("br"),q=B(),v(I.$$.fragment)},l(l){w(e.$$.fragment,l),n=F(l),t=P(l,"BR",{}),r=F(l),w(s.$$.fragment,l),a=F(l),w(c.$$.fragment,l),g=F(l),w(u.$$.fragment,l),i=F(l),_=P(l,"BR",{}),m=F(l),w(C.$$.fragment,l),U=F(l),V=P(l,"BR",{}),q=F(l),w(I.$$.fragment,l)},m(l,$){k(e,l,$),T(l,n,$),T(l,t,$),T(l,r,$),k(s,l,$),T(l,a,$),k(c,l,$),T(l,g,$),k(u,l,$),T(l,i,$),T(l,_,$),T(l,m,$),k(C,l,$),T(l,U,$),T(l,V,$),T(l,q,$),k(I,l,$),p=!0,R||(D=ae(window,"keydown",o[6]),R=!0)},p(l,[$]){const Q={};$&131072&&(Q.$$scope={dirty:$,ctx:l}),e.$set(Q);const W={};$&131074&&(W.$$scope={dirty:$,ctx:l}),s.$set(W);const X={};!f&&$&4&&(f=!0,X.tags=l[2],z(()=>f=!1)),c.$set(X);const Z={};$&131097&&(Z.$$scope={dirty:$,ctx:l}),u.$set(Z);const J={};$&131072&&(J.$$scope={dirty:$,ctx:l}),C.$set(J);const Y={};$&131104&&(Y.$$scope={dirty:$,ctx:l}),I.$set(Y)},i(l){p||(d(e.$$.fragment,l),d(s.$$.fragment,l),d(c.$$.fragment,l),d(u.$$.fragment,l),d(C.$$.fragment,l),d(I.$$.fragment,l),p=!0)},o(l){b(e.$$.fragment,l),b(s.$$.fragment,l),b(c.$$.fragment,l),b(u.$$.fragment,l),b(C.$$.fragment,l),b(I.$$.fragment,l),p=!1},d(l){E(e,l),l&&h(n),l&&h(t),l&&h(r),E(s,l),l&&h(a),E(c,l),l&&h(g),E(u,l),l&&h(i),l&&h(_),l&&h(m),E(C,l),l&&h(U),l&&h(V),l&&h(q),E(I,l),R=!1,D()}}}const gt=async({session:o})=>{let e=o.user;return e?{props:{user:e}}:{status:302,redirect:Ce.login}};function Ze(o,e,n){let t;he(o,ne,p=>n(14,t=p));let{user:r}=e,s=r.username,a=r.hidden,c=r.image,f=r.tags||[],g,u,i;const _=p=>{switch(p.keyCode){case 13:p.ctrlKey&&m()}},m=async()=>{if(n(5,i=!0),!s){n(3,g=!0),n(4,u="Empty"),n(5,i=!1);return}if(s!==r.username&&await te.get(`check_username/${s}`).then(D=>!D.res)){n(3,g=!0),n(4,u="Username taken"),n(5,i=!1);return}let p={username:s,hidden:a,image:c,tags:f},R=await te.put("users",p).finally(D=>(n(5,i=!1),D));R.id&&(ve(ne,t.user=R,t),Ie(`/u/${R.id}`))};function C(p){a=p,n(1,a)}function U(p){f=p,n(2,f)}function V(p){u=p,n(4,u)}function q(p){g=p,n(3,g)}function I(p){s=p,n(0,s)}return o.$$set=p=>{"user"in p&&n(8,r=p.user)},[s,a,f,g,u,i,_,m,r,C,U,V,q,I]}class dt extends se{constructor(e){super(),le(this,e,Ze,Xe,oe,{user:8})}}export{dt as default,gt as load};
