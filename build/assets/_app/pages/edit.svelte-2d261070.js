import{S as e,i as t,s as n,e as s,a5 as a,c as $,a as r,d as o,aa as c,b as i,a4 as l,ab as f,z as m,E as u,F as p,a1 as d,j as g,k as h,m as v,n as w,o as x,f as k,O as b,G as y,v as j,r as T,w as E,a2 as I,l as z,B as A,u as P,aA as S,ak as C,am as G,an as _,aB as N,A as U,t as F,g as R,af as B,ac as D,p as K,U as L}from"../chunks/vendor-c4839857.js";import{a as V}from"../chunks/api-5c0c9630.js";import{g as H}from"../chunks/navigation-20968cc5.js";import{F as M}from"../chunks/Fields-899c614d.js";import{I as O}from"../chunks/Input-7298b594.js";import{I as Y}from"../chunks/Image-b1d9aafa.js";import{T as q}from"../chunks/Tag-87cdacdd.js";import{c as J}from"../chunks/checkEmail-33bd547c.js";import{a as Q}from"../chunks/abslink-3768d0d8.js";import"../chunks/post-5b27026c.js";import"../chunks/singletons-bb9012b7.js";function W(e){let t,n;return{c(){t=s("script"),this.h()},l(e){const n=a('[data-svelte="svelte-1eu2i5p"]',document.head);t=$(n,"SCRIPT",{src:!0}),r(t).forEach(o),n.forEach(o),this.h()},h(){c(t.src,n="https://js.paystack.co/v1/inline.js")||i(t,"src","https://js.paystack.co/v1/inline.js")},m(e,n){l(document.head,t)},p:f,i:f,o:f,d(e){o(t)}}}function X(e,t,n){let{config:s={}}=t,a=!1;return m((()=>{n(1,a=!0)})),e.$$set=e=>{"config"in e&&n(0,s=e.config)},e.$$.update=()=>{3&e.$$.dirty&&a&&s.open&&PaystackPop.setup(s).openIframe()},[s,a]}class Z extends e{constructor(e){super(),t(this,e,X,W,n,{config:0})}}function ee(e){let t,n;return t=new G({props:{size:"small",$$slots:{default:[ne]},$$scope:{ctx:e}}}),t.$on("click",e[22]),{c(){g(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,s){x(t,e,s),n=!0},p(e,n){const s={};1024&n[1]&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){n||(j(t.$$.fragment,e),n=!0)},o(e){T(t.$$.fragment,e),n=!1},d(e){E(t,e)}}}function te(e){let t,n,s,a;return t=new G({props:{size:"small",$$slots:{default:[se]},$$scope:{ctx:e}}}),t.$on("click",e[20]),s=new G({props:{size:"small",$$slots:{default:[ae]},$$scope:{ctx:e}}}),s.$on("click",e[21]),{c(){g(t.$$.fragment),n=h(),g(s.$$.fragment)},l(e){v(t.$$.fragment,e),n=w(e),v(s.$$.fragment,e)},m(e,$){x(t,e,$),k(e,n,$),x(s,e,$),a=!0},p(e,n){const a={};1024&n[1]&&(a.$$scope={dirty:n,ctx:e}),t.$set(a);const $={};1024&n[1]&&($.$$scope={dirty:n,ctx:e}),s.$set($)},i(e){a||(j(t.$$.fragment,e),j(s.$$.fragment,e),a=!0)},o(e){T(t.$$.fragment,e),T(s.$$.fragment,e),a=!1},d(e){E(t,e),e&&o(n),E(s,e)}}}function ne(e){let t;return{c(){t=F("Subscribe")},l(e){t=R(e,"Subscribe")},m(e,n){k(e,t,n)},d(e){e&&o(t)}}}function se(e){let t;return{c(){t=F("Renew subscription")},l(e){t=R(e,"Renew subscription")},m(e,n){k(e,t,n)},d(e){e&&o(t)}}}function ae(e){let t;return{c(){t=F("Change card")},l(e){t=R(e,"Change card")},m(e,n){k(e,t,n)},d(e){e&&o(t)}}}function $e(e){let t,n,s,a;const $=[te,ee],r=[];function c(e,t){return e[0].paid?0:1}return t=c(e),n=r[t]=$[t](e),{c(){n.c(),s=z()},l(e){n.l(e),s=z()},m(e,n){r[t].m(e,n),k(e,s,n),a=!0},p(e,a){let o=t;t=c(e),t===o?r[t].p(e,a):(A(),T(r[o],1,1,(()=>{r[o]=null})),P(),n=r[t],n?n.p(e,a):(n=r[t]=$[t](e),n.c()),j(n,1),n.m(s.parentNode,s))},i(e){a||(j(n),a=!0)},o(e){T(n),a=!1},d(e){r[t].d(e),e&&o(s)}}}function re(e){let t,n,s;function a(t){e[24](t)}let $={labelText:"Hidden"};return void 0!==e[4]&&($.checked=e[4]),t=new S({props:$}),u.push((()=>p(t,"checked",a))),{c(){g(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,n){x(t,e,n),s=!0},p(e,s){const a={};!n&&16&s[0]&&(n=!0,a.checked=e[4],y((()=>n=!1))),t.$set(a)},i(e){s||(j(t.$$.fragment,e),s=!0)},o(e){T(t.$$.fragment,e),s=!1},d(e){E(t,e)}}}function oe(e){let t,n;return t=new I({props:{$$slots:{default:[re]},$$scope:{ctx:e}}}),{c(){g(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,s){x(t,e,s),n=!0},p(e,n){const s={};16&n[0]|1024&n[1]&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){n||(j(t.$$.fragment,e),n=!0)},o(e){T(t.$$.fragment,e),n=!1},d(e){E(t,e)}}}function ce(e){let t,n,s;function a(t){e[26](t)}let $={pin:!0};return void 0!==e[12]&&($.fields=e[12]),t=new M({props:$}),u.push((()=>p(t,"fields",a))),{c(){g(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,n){x(t,e,n),s=!0},p(e,s){const a={};!n&&4096&s[0]&&(n=!0,a.fields=e[12],y((()=>n=!1))),t.$set(a)},i(e){s||(j(t.$$.fragment,e),s=!0)},o(e){T(t.$$.fragment,e),s=!1},d(e){E(t,e)}}}function ie(e){let t,n;return t=new I({props:{$$slots:{default:[ce]},$$scope:{ctx:e}}}),{c(){g(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,s){x(t,e,s),n=!0},p(e,n){const s={};4096&n[0]|1024&n[1]&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){n||(j(t.$$.fragment,e),n=!0)},o(e){T(t.$$.fragment,e),n=!1},d(e){E(t,e)}}}function le(e){let t,n,s,a,$,r,c,i,l,f,m,d,b,I,z,A,P,C,G,U,F,R,B,D,K,L;function V(t){e[27](t)}function H(t){e[28](t)}function M(t){e[29](t)}let Y={labelText:"Username"};function q(t){e[30](t)}void 0!==e[15]&&(Y.invalidText=e[15]),void 0!==e[14]&&(Y.invalid=e[14]),void 0!==e[3]&&(Y.value=e[3]),t=new O({props:Y}),u.push((()=>p(t,"invalidText",V))),u.push((()=>p(t,"invalid",H))),u.push((()=>p(t,"value",M)));let J={labelText:"Show email in profile"};function Q(t){e[31](t)}void 0!==e[2]&&(J.checked=e[2]),r=new S({props:J}),u.push((()=>p(r,"checked",q)));let W={labelText:"Email"};function X(t){e[32](t)}void 0!==e[8]&&(W.value=e[8]),l=new _({props:W}),u.push((()=>p(l,"value",Q)));let Z={labelText:"Name"};function ee(t){e[33](t)}void 0!==e[11]&&(Z.value=e[11]),d=new _({props:Z}),u.push((()=>p(d,"value",X)));let te={labelText:"Phone"};function ne(t){e[34](t)}void 0!==e[9]&&(te.value=e[9]),z=new _({props:te}),u.push((()=>p(z,"value",ee)));let se={labelText:"Address"};function ae(t){e[35](t)}void 0!==e[5]&&(se.value=e[5]),C=new _({props:se}),u.push((()=>p(C,"value",ne)));let $e={invalid:e[16],invalidText:we,labelText:"Link"};function re(t){e[36](t)}void 0!==e[6]&&($e.value=e[6]),F=new O({props:$e}),u.push((()=>p(F,"value",ae)));let oe={rows:11,placeholder:"About (Markdown)"};return void 0!==e[10]&&(oe.value=e[10]),D=new N({props:oe}),u.push((()=>p(D,"value",re))),{c(){g(t.$$.fragment),$=h(),g(r.$$.fragment),i=h(),g(l.$$.fragment),m=h(),g(d.$$.fragment),I=h(),g(z.$$.fragment),P=h(),g(C.$$.fragment),U=h(),g(F.$$.fragment),B=h(),g(D.$$.fragment)},l(e){v(t.$$.fragment,e),$=w(e),v(r.$$.fragment,e),i=w(e),v(l.$$.fragment,e),m=w(e),v(d.$$.fragment,e),I=w(e),v(z.$$.fragment,e),P=w(e),v(C.$$.fragment,e),U=w(e),v(F.$$.fragment,e),B=w(e),v(D.$$.fragment,e)},m(e,n){x(t,e,n),k(e,$,n),x(r,e,n),k(e,i,n),x(l,e,n),k(e,m,n),x(d,e,n),k(e,I,n),x(z,e,n),k(e,P,n),x(C,e,n),k(e,U,n),x(F,e,n),k(e,B,n),x(D,e,n),L=!0},p(e,$){const o={};!n&&32768&$[0]&&(n=!0,o.invalidText=e[15],y((()=>n=!1))),!s&&16384&$[0]&&(s=!0,o.invalid=e[14],y((()=>s=!1))),!a&&8&$[0]&&(a=!0,o.value=e[3],y((()=>a=!1))),t.$set(o);const i={};!c&&4&$[0]&&(c=!0,i.checked=e[2],y((()=>c=!1))),r.$set(i);const m={};!f&&256&$[0]&&(f=!0,m.value=e[8],y((()=>f=!1))),l.$set(m);const u={};!b&&2048&$[0]&&(b=!0,u.value=e[11],y((()=>b=!1))),d.$set(u);const p={};!A&&512&$[0]&&(A=!0,p.value=e[9],y((()=>A=!1))),z.$set(p);const g={};!G&&32&$[0]&&(G=!0,g.value=e[5],y((()=>G=!1))),C.$set(g);const h={};65536&$[0]&&(h.invalid=e[16]),!R&&64&$[0]&&(R=!0,h.value=e[6],y((()=>R=!1))),F.$set(h);const v={};!K&&1024&$[0]&&(K=!0,v.value=e[10],y((()=>K=!1))),D.$set(v)},i(e){L||(j(t.$$.fragment,e),j(r.$$.fragment,e),j(l.$$.fragment,e),j(d.$$.fragment,e),j(z.$$.fragment,e),j(C.$$.fragment,e),j(F.$$.fragment,e),j(D.$$.fragment,e),L=!0)},o(e){T(t.$$.fragment,e),T(r.$$.fragment,e),T(l.$$.fragment,e),T(d.$$.fragment,e),T(z.$$.fragment,e),T(C.$$.fragment,e),T(F.$$.fragment,e),T(D.$$.fragment,e),L=!1},d(e){E(t,e),e&&o($),E(r,e),e&&o(i),E(l,e),e&&o(m),E(d,e),e&&o(I),E(z,e),e&&o(P),E(C,e),e&&o(U),E(F,e),e&&o(B),E(D,e)}}}function fe(e){let t,n;return t=new C({props:{$$slots:{default:[le]},$$scope:{ctx:e}}}),{c(){g(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,s){x(t,e,s),n=!0},p(e,n){const s={};118636&n[0]|1024&n[1]&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){n||(j(t.$$.fragment,e),n=!0)},o(e){T(t.$$.fragment,e),n=!1},d(e){E(t,e)}}}function me(e){let t,n;return t=new I({props:{$$slots:{default:[fe]},$$scope:{ctx:e}}}),{c(){g(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,s){x(t,e,s),n=!0},p(e,n){const s={};118636&n[0]|1024&n[1]&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){n||(j(t.$$.fragment,e),n=!0)},o(e){T(t.$$.fragment,e),n=!1},d(e){E(t,e)}}}function ue(e){let t,n,a;return n=new L({}),{c(){t=s("div"),g(n.$$.fragment),this.h()},l(e){t=$(e,"DIV",{class:!0});var s=r(t);v(n.$$.fragment,s),s.forEach(o),this.h()},h(){i(t,"class","right svelte-pb9zr2")},m(e,s){k(e,t,s),x(n,t,null),a=!0},i(e){a||(j(n.$$.fragment,e),a=!0)},o(e){T(n.$$.fragment,e),a=!1},d(e){e&&o(t),E(n)}}}function pe(e){let t,n,a,c,i,f,m,u=e[17]&&ue(),p=[e[40]],d={};for(let s=0;s<p.length;s+=1)d=U(d,p[s]);return{c(){t=s("div"),n=s("p"),a=F("Edit"),c=h(),u&&u.c(),this.h()},l(e){t=$(e,"DIV",{});var s=r(t);n=$(s,"P",{});var i=r(n);a=R(i,"Edit"),i.forEach(o),c=w(s),u&&u.l(s),s.forEach(o),this.h()},h(){B(t,d),D(t,"svelte-pb9zr2",!0)},m(s,$){k(s,t,$),l(t,n),l(n,a),l(t,c),u&&u.m(t,null),i=!0,f||(m=b(t,"click",e[19]),f=!0)},p(e,n){e[17]?u?131072&n[0]&&j(u,1):(u=ue(),u.c(),j(u,1),u.m(t,null)):u&&(A(),T(u,1,1,(()=>{u=null})),P()),B(t,d=K(p,[512&n[1]&&e[40]])),D(t,"svelte-pb9zr2",!0)},i(e){i||(j(u),i=!0)},o(e){T(u),i=!1},d(e){e&&o(t),u&&u.d(),f=!1,m()}}}function de(e){let t,n;return t=new G({props:{as:!0,$$slots:{default:[pe,({props:e})=>({40:e}),({props:e})=>[0,e?512:0]]},$$scope:{ctx:e}}}),{c(){g(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,s){x(t,e,s),n=!0},p(e,n){const s={};131072&n[0]|1536&n[1]&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){n||(j(t.$$.fragment,e),n=!0)},o(e){T(t.$$.fragment,e),n=!1},d(e){E(t,e)}}}function ge(e){let t,n;return t=new I({props:{$$slots:{default:[de]},$$scope:{ctx:e}}}),{c(){g(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,s){x(t,e,s),n=!0},p(e,n){const s={};131072&n[0]|1024&n[1]&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){n||(j(t.$$.fragment,e),n=!0)},o(e){T(t.$$.fragment,e),n=!1},d(e){E(t,e)}}}function he(e){let t,n,s,a,$,r,c,i,l,f,m,I,z,A,P,S,C,G;function _(t){e[23](t)}t=new Z({props:{config:e[1]}});let N={$$slots:{default:[$e]},$$scope:{ctx:e}};function U(t){e[25](t)}void 0!==e[7]&&(N.image=e[7]),s=new Y({props:N}),u.push((()=>p(s,"image",_))),r=new d({props:{noGutter:!0,$$slots:{default:[oe]},$$scope:{ctx:e}}});let F={};return void 0!==e[13]&&(F.tags=e[13]),i=new q({props:F}),u.push((()=>p(i,"tags",U))),m=new d({props:{$$slots:{default:[ie]},$$scope:{ctx:e}}}),z=new d({props:{noGutter:!0,$$slots:{default:[me]},$$scope:{ctx:e}}}),P=new d({props:{noGutter:!0,$$slots:{default:[ge]},$$scope:{ctx:e}}}),{c(){g(t.$$.fragment),n=h(),g(s.$$.fragment),$=h(),g(r.$$.fragment),c=h(),g(i.$$.fragment),f=h(),g(m.$$.fragment),I=h(),g(z.$$.fragment),A=h(),g(P.$$.fragment)},l(e){v(t.$$.fragment,e),n=w(e),v(s.$$.fragment,e),$=w(e),v(r.$$.fragment,e),c=w(e),v(i.$$.fragment,e),f=w(e),v(m.$$.fragment,e),I=w(e),v(z.$$.fragment,e),A=w(e),v(P.$$.fragment,e)},m(a,o){x(t,a,o),k(a,n,o),x(s,a,o),k(a,$,o),x(r,a,o),k(a,c,o),x(i,a,o),k(a,f,o),x(m,a,o),k(a,I,o),x(z,a,o),k(a,A,o),x(P,a,o),S=!0,C||(G=b(window,"keydown",e[18]),C=!0)},p(e,n){const $={};2&n[0]&&($.config=e[1]),t.$set($);const o={};3&n[0]|1024&n[1]&&(o.$$scope={dirty:n,ctx:e}),!a&&128&n[0]&&(a=!0,o.image=e[7],y((()=>a=!1))),s.$set(o);const c={};16&n[0]|1024&n[1]&&(c.$$scope={dirty:n,ctx:e}),r.$set(c);const f={};!l&&8192&n[0]&&(l=!0,f.tags=e[13],y((()=>l=!1))),i.$set(f);const u={};4096&n[0]|1024&n[1]&&(u.$$scope={dirty:n,ctx:e}),m.$set(u);const p={};118636&n[0]|1024&n[1]&&(p.$$scope={dirty:n,ctx:e}),z.$set(p);const d={};131072&n[0]|1024&n[1]&&(d.$$scope={dirty:n,ctx:e}),P.$set(d)},i(e){S||(j(t.$$.fragment,e),j(s.$$.fragment,e),j(r.$$.fragment,e),j(i.$$.fragment,e),j(m.$$.fragment,e),j(z.$$.fragment,e),j(P.$$.fragment,e),S=!0)},o(e){T(t.$$.fragment,e),T(s.$$.fragment,e),T(r.$$.fragment,e),T(i.$$.fragment,e),T(m.$$.fragment,e),T(z.$$.fragment,e),T(P.$$.fragment,e),S=!1},d(e){E(t,e),e&&o(n),E(s,e),e&&o($),E(r,e),e&&o(c),E(i,e),e&&o(f),E(m,e),e&&o(I),E(z,e),e&&o(A),E(P,e),C=!1,G()}}}async function ve({session:e}){let t=e.user;return t?{props:{user:t}}:(console.log("load-session not user"),{status:302,redirect:"/login"})}let we='Add a url scheme to the link, something like "http://, at the beginning';function xe(e,t,n){let s,a,$,r,{user:o={}}=t,c={key:{}.PAYSTACK,email:o.email,metadata:{id:o.id},amount:190233,currency:"NGN",embed:!1,value:"Pay"},i=o.show_email,l=o.username,f=o.hidden,m=o.address,u=o.website,p=o.image,d=o.email,g=o.phone,h=o.about,v=o.data,w=o.name,x=o.fields||[],k=o.tags||[];const b=async()=>{if(n(17,r=!0),u&&!Q.test(u))return console.log("website err"),n(16,$=!0),void(editLoading=!1);if(!d)return console.log("not email err"),void n(17,r=!1);if(!J(d))return console.log("check email err"),void n(17,r=!1);if(!l)return console.log("username err"),n(14,s=!0),n(15,a="Empty"),void n(17,r=!1);if(l!==o.username&&await V.get(`check_username/${l}`).then((e=>!e.res)))return console.log("api check_username err"),n(14,s=!0),n(15,a="Username taken"),void n(17,r=!1);if(J(l))return console.log("check email username err"),n(14,s=!0),n(15,a="Unaccepted"),void n(17,r=!1);let e={show_email:i,username:l,hidden:f,website:u,address:m,email:d,phone:g,about:h,image:p,data:v,tags:k,name:w},t=await V.put("users",e).finally((e=>(console.log("edit res: ",e),n(17,r=!1),e)));t.id&&H(`/${t.username}`)};return e.$$set=e=>{"user"in e&&n(0,o=e.user)},[o,c,i,l,f,m,u,p,d,g,h,w,x,k,s,a,$,r,e=>{switch(e.keyCode){case 13:e.ctrlKey&&b()}},b,()=>{n(1,c.open=!0,c)},()=>{n(1,c.open=!0,c),n(1,c.amount=3e3,c),n(1,c.metadata.purpose="change_card",c)},()=>{n(1,c.open=!0,c)},function(e){p=e,n(7,p)},function(e){f=e,n(4,f)},function(e){k=e,n(13,k)},function(e){x=e,n(12,x)},function(e){a=e,n(15,a)},function(e){s=e,n(14,s)},function(e){l=e,n(3,l)},function(e){i=e,n(2,i)},function(e){d=e,n(8,d)},function(e){w=e,n(11,w)},function(e){g=e,n(9,g)},function(e){m=e,n(5,m)},function(e){u=e,n(6,u)},function(e){h=e,n(10,h)}]}export default class extends e{constructor(e){super(),t(this,e,xe,he,n,{user:0},null,[-1,-1])}}export{ve as load};
