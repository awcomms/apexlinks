import{S as e,i as t,s as n,E as a,F as $,a3 as s,j as r,k as o,m as c,n as i,o as f,f as l,O as m,G as u,v as p,r as g,w as d,d as h,a4 as v,l as w,B as x,u as b,ay as k,aw as y,an as T,au as j,az as E,e as z,c as P,a as A,b as I,A as G,t as S,g as C,aj as N,ah as U,a6 as _,p as D,U as K}from"../chunks/vendor-221a53e8.js";import{g as L,p as R}from"../chunks/api-464cac91.js";import{g as V}from"../chunks/navigation-20968cc5.js";import{P as B}from"../chunks/Paystack-be93ea47.js";import{I as F}from"../chunks/Input-cd25684c.js";import{I as M}from"../chunks/Image-ffc55824.js";import{T as O}from"../chunks/Tag-9a4ea10c.js";import{a as Y,c as q}from"../chunks/utils-6d6449a6.js";import"../chunks/singletons-bb9012b7.js";function H(e){let t,n;return t=new T({props:{size:"small",$$slots:{default:[Q]},$$scope:{ctx:e}}}),t.$on("click",e[21]),{c(){r(t.$$.fragment)},l(e){c(t.$$.fragment,e)},m(e,a){f(t,e,a),n=!0},p(e,n){const a={};512&n[1]&&(a.$$scope={dirty:n,ctx:e}),t.$set(a)},i(e){n||(p(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){d(t,e)}}}function J(e){let t,n,a,$;return t=new T({props:{size:"small",$$slots:{default:[W]},$$scope:{ctx:e}}}),t.$on("click",e[19]),a=new T({props:{size:"small",$$slots:{default:[X]},$$scope:{ctx:e}}}),a.$on("click",e[20]),{c(){r(t.$$.fragment),n=o(),r(a.$$.fragment)},l(e){c(t.$$.fragment,e),n=i(e),c(a.$$.fragment,e)},m(e,s){f(t,e,s),l(e,n,s),f(a,e,s),$=!0},p(e,n){const $={};512&n[1]&&($.$$scope={dirty:n,ctx:e}),t.$set($);const s={};512&n[1]&&(s.$$scope={dirty:n,ctx:e}),a.$set(s)},i(e){$||(p(t.$$.fragment,e),p(a.$$.fragment,e),$=!0)},o(e){g(t.$$.fragment,e),g(a.$$.fragment,e),$=!1},d(e){d(t,e),e&&h(n),d(a,e)}}}function Q(e){let t;return{c(){t=S("Subscribe")},l(e){t=C(e,"Subscribe")},m(e,n){l(e,t,n)},d(e){e&&h(t)}}}function W(e){let t;return{c(){t=S("Renew subscription")},l(e){t=C(e,"Renew subscription")},m(e,n){l(e,t,n)},d(e){e&&h(t)}}}function X(e){let t;return{c(){t=S("Change card")},l(e){t=C(e,"Change card")},m(e,n){l(e,t,n)},d(e){e&&h(t)}}}function Z(e){let t,n,a,$;const s=[J,H],r=[];function o(e,t){return e[0].paid?0:1}return t=o(e),n=r[t]=s[t](e),{c(){n.c(),a=w()},l(e){n.l(e),a=w()},m(e,n){r[t].m(e,n),l(e,a,n),$=!0},p(e,$){let c=t;t=o(e),t===c?r[t].p(e,$):(x(),g(r[c],1,1,(()=>{r[c]=null})),b(),n=r[t],n?n.p(e,$):(n=r[t]=s[t](e),n.c()),p(n,1),n.m(a.parentNode,a))},i(e){$||(p(n),$=!0)},o(e){g(n),$=!1},d(e){r[t].d(e),e&&h(a)}}}function ee(e){let t,n,s;function o(t){e[23](t)}let i={labelText:"Public"};return void 0!==e[4]&&(i.checked=e[4]),t=new k({props:i}),a.push((()=>$(t,"checked",o))),{c(){r(t.$$.fragment)},l(e){c(t.$$.fragment,e)},m(e,n){f(t,e,n),s=!0},p(e,a){const $={};!n&&16&a[0]&&(n=!0,$.checked=e[4],u((()=>n=!1))),t.$set($)},i(e){s||(p(t.$$.fragment,e),s=!0)},o(e){g(t.$$.fragment,e),s=!1},d(e){d(t,e)}}}function te(e){let t,n;return t=new v({props:{$$slots:{default:[ee]},$$scope:{ctx:e}}}),{c(){r(t.$$.fragment)},l(e){c(t.$$.fragment,e)},m(e,a){f(t,e,a),n=!0},p(e,n){const a={};16&n[0]|512&n[1]&&(a.$$scope={dirty:n,ctx:e}),t.$set(a)},i(e){n||(p(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){d(t,e)}}}function ne(e){let t,n,s,m,v,w,x,b,y,T,z,P,A,I,G,S,C,N,U,_,D,K,L,R,V,B;function M(t){e[25](t)}function O(t){e[26](t)}function Y(t){e[27](t)}let q={labelText:"Username"};function H(t){e[28](t)}void 0!==e[14]&&(q.invalidText=e[14]),void 0!==e[13]&&(q.invalid=e[13]),void 0!==e[3]&&(q.value=e[3]),t=new F({props:q}),a.push((()=>$(t,"invalidText",M))),a.push((()=>$(t,"invalid",O))),a.push((()=>$(t,"value",Y)));let J={labelText:"Show email in profile"};function Q(t){e[29](t)}void 0!==e[2]&&(J.checked=e[2]),w=new k({props:J}),a.push((()=>$(w,"checked",H)));let W={labelText:"Email"};function X(t){e[30](t)}void 0!==e[8]&&(W.value=e[8]),y=new j({props:W}),a.push((()=>$(y,"value",Q)));let Z={labelText:"Name"};function ee(t){e[31](t)}void 0!==e[11]&&(Z.value=e[11]),P=new j({props:Z}),a.push((()=>$(P,"value",X)));let te={labelText:"Phone"};function ne(t){e[32](t)}void 0!==e[9]&&(te.value=e[9]),G=new j({props:te}),a.push((()=>$(G,"value",ee)));let ae={labelText:"Address"};function $e(t){e[33](t)}void 0!==e[5]&&(ae.value=e[5]),N=new j({props:ae}),a.push((()=>$(N,"value",ne)));let se={invalid:e[15],invalidText:le,labelText:"Link"};function re(t){e[34](t)}void 0!==e[6]&&(se.value=e[6]),D=new F({props:se}),a.push((()=>$(D,"value",$e)));let oe={rows:11,placeholder:"About (Markdown)"};return void 0!==e[10]&&(oe.value=e[10]),R=new E({props:oe}),a.push((()=>$(R,"value",re))),{c(){r(t.$$.fragment),v=o(),r(w.$$.fragment),b=o(),r(y.$$.fragment),z=o(),r(P.$$.fragment),I=o(),r(G.$$.fragment),C=o(),r(N.$$.fragment),_=o(),r(D.$$.fragment),L=o(),r(R.$$.fragment)},l(e){c(t.$$.fragment,e),v=i(e),c(w.$$.fragment,e),b=i(e),c(y.$$.fragment,e),z=i(e),c(P.$$.fragment,e),I=i(e),c(G.$$.fragment,e),C=i(e),c(N.$$.fragment,e),_=i(e),c(D.$$.fragment,e),L=i(e),c(R.$$.fragment,e)},m(e,n){f(t,e,n),l(e,v,n),f(w,e,n),l(e,b,n),f(y,e,n),l(e,z,n),f(P,e,n),l(e,I,n),f(G,e,n),l(e,C,n),f(N,e,n),l(e,_,n),f(D,e,n),l(e,L,n),f(R,e,n),B=!0},p(e,a){const $={};!n&&16384&a[0]&&(n=!0,$.invalidText=e[14],u((()=>n=!1))),!s&&8192&a[0]&&(s=!0,$.invalid=e[13],u((()=>s=!1))),!m&&8&a[0]&&(m=!0,$.value=e[3],u((()=>m=!1))),t.$set($);const r={};!x&&4&a[0]&&(x=!0,r.checked=e[2],u((()=>x=!1))),w.$set(r);const o={};!T&&256&a[0]&&(T=!0,o.value=e[8],u((()=>T=!1))),y.$set(o);const c={};!A&&2048&a[0]&&(A=!0,c.value=e[11],u((()=>A=!1))),P.$set(c);const i={};!S&&512&a[0]&&(S=!0,i.value=e[9],u((()=>S=!1))),G.$set(i);const f={};!U&&32&a[0]&&(U=!0,f.value=e[5],u((()=>U=!1))),N.$set(f);const l={};32768&a[0]&&(l.invalid=e[15]),!K&&64&a[0]&&(K=!0,l.value=e[6],u((()=>K=!1))),D.$set(l);const p={};!V&&1024&a[0]&&(V=!0,p.value=e[10],u((()=>V=!1))),R.$set(p)},i(e){B||(p(t.$$.fragment,e),p(w.$$.fragment,e),p(y.$$.fragment,e),p(P.$$.fragment,e),p(G.$$.fragment,e),p(N.$$.fragment,e),p(D.$$.fragment,e),p(R.$$.fragment,e),B=!0)},o(e){g(t.$$.fragment,e),g(w.$$.fragment,e),g(y.$$.fragment,e),g(P.$$.fragment,e),g(G.$$.fragment,e),g(N.$$.fragment,e),g(D.$$.fragment,e),g(R.$$.fragment,e),B=!1},d(e){d(t,e),e&&h(v),d(w,e),e&&h(b),d(y,e),e&&h(z),d(P,e),e&&h(I),d(G,e),e&&h(C),d(N,e),e&&h(_),d(D,e),e&&h(L),d(R,e)}}}function ae(e){let t,n;return t=new y({props:{$$slots:{default:[ne]},$$scope:{ctx:e}}}),{c(){r(t.$$.fragment)},l(e){c(t.$$.fragment,e)},m(e,a){f(t,e,a),n=!0},p(e,n){const a={};61292&n[0]|512&n[1]&&(a.$$scope={dirty:n,ctx:e}),t.$set(a)},i(e){n||(p(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){d(t,e)}}}function $e(e){let t,n;return t=new v({props:{$$slots:{default:[ae]},$$scope:{ctx:e}}}),{c(){r(t.$$.fragment)},l(e){c(t.$$.fragment,e)},m(e,a){f(t,e,a),n=!0},p(e,n){const a={};61292&n[0]|512&n[1]&&(a.$$scope={dirty:n,ctx:e}),t.$set(a)},i(e){n||(p(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){d(t,e)}}}function se(e){let t,n,a;return n=new K({}),{c(){t=z("div"),r(n.$$.fragment),this.h()},l(e){t=P(e,"DIV",{class:!0});var a=A(t);c(n.$$.fragment,a),a.forEach(h),this.h()},h(){I(t,"class","right svelte-pb9zr2")},m(e,$){l(e,t,$),f(n,t,null),a=!0},i(e){a||(p(n.$$.fragment,e),a=!0)},o(e){g(n.$$.fragment,e),a=!1},d(e){e&&h(t),d(n)}}}function re(e){let t,n,a,$,s,r,c,f=e[16]&&se(),u=[e[39]],d={};for(let o=0;o<u.length;o+=1)d=G(d,u[o]);return{c(){t=z("div"),n=z("p"),a=S("Edit"),$=o(),f&&f.c(),this.h()},l(e){t=P(e,"DIV",{});var s=A(t);n=P(s,"P",{});var r=A(n);a=C(r,"Edit"),r.forEach(h),$=i(s),f&&f.l(s),s.forEach(h),this.h()},h(){N(t,d),U(t,"svelte-pb9zr2",!0)},m(o,i){l(o,t,i),_(t,n),_(n,a),_(t,$),f&&f.m(t,null),s=!0,r||(c=m(t,"click",e[18]),r=!0)},p(e,n){e[16]?f?65536&n[0]&&p(f,1):(f=se(),f.c(),p(f,1),f.m(t,null)):f&&(x(),g(f,1,1,(()=>{f=null})),b()),N(t,d=D(u,[256&n[1]&&e[39]])),U(t,"svelte-pb9zr2",!0)},i(e){s||(p(f),s=!0)},o(e){g(f),s=!1},d(e){e&&h(t),f&&f.d(),r=!1,c()}}}function oe(e){let t,n;return t=new T({props:{as:!0,$$slots:{default:[re,({props:e})=>({39:e}),({props:e})=>[0,e?256:0]]},$$scope:{ctx:e}}}),{c(){r(t.$$.fragment)},l(e){c(t.$$.fragment,e)},m(e,a){f(t,e,a),n=!0},p(e,n){const a={};65536&n[0]|768&n[1]&&(a.$$scope={dirty:n,ctx:e}),t.$set(a)},i(e){n||(p(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){d(t,e)}}}function ce(e){let t,n;return t=new v({props:{$$slots:{default:[oe]},$$scope:{ctx:e}}}),{c(){r(t.$$.fragment)},l(e){c(t.$$.fragment,e)},m(e,a){f(t,e,a),n=!0},p(e,n){const a={};65536&n[0]|512&n[1]&&(a.$$scope={dirty:n,ctx:e}),t.$set(a)},i(e){n||(p(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){d(t,e)}}}function ie(e){let t,n,v,w,x,b,k,y,T,j,E,z,P,A,I,G;function S(t){e[22](t)}t=new B({props:{config:e[1]}});let C={$$slots:{default:[Z]},$$scope:{ctx:e}};function N(t){e[24](t)}void 0!==e[7]&&(C.image=e[7]),v=new M({props:C}),a.push((()=>$(v,"image",S))),b=new s({props:{noGutter:!0,$$slots:{default:[te]},$$scope:{ctx:e}}});let U={};return void 0!==e[12]&&(U.tags=e[12]),y=new O({props:U}),a.push((()=>$(y,"tags",N))),E=new s({props:{noGutter:!0,$$slots:{default:[$e]},$$scope:{ctx:e}}}),P=new s({props:{noGutter:!0,$$slots:{default:[ce]},$$scope:{ctx:e}}}),{c(){r(t.$$.fragment),n=o(),r(v.$$.fragment),x=o(),r(b.$$.fragment),k=o(),r(y.$$.fragment),j=o(),r(E.$$.fragment),z=o(),r(P.$$.fragment)},l(e){c(t.$$.fragment,e),n=i(e),c(v.$$.fragment,e),x=i(e),c(b.$$.fragment,e),k=i(e),c(y.$$.fragment,e),j=i(e),c(E.$$.fragment,e),z=i(e),c(P.$$.fragment,e)},m(a,$){f(t,a,$),l(a,n,$),f(v,a,$),l(a,x,$),f(b,a,$),l(a,k,$),f(y,a,$),l(a,j,$),f(E,a,$),l(a,z,$),f(P,a,$),A=!0,I||(G=m(window,"keydown",e[17]),I=!0)},p(e,n){const a={};2&n[0]&&(a.config=e[1]),t.$set(a);const $={};3&n[0]|512&n[1]&&($.$$scope={dirty:n,ctx:e}),!w&&128&n[0]&&(w=!0,$.image=e[7],u((()=>w=!1))),v.$set($);const s={};16&n[0]|512&n[1]&&(s.$$scope={dirty:n,ctx:e}),b.$set(s);const r={};!T&&4096&n[0]&&(T=!0,r.tags=e[12],u((()=>T=!1))),y.$set(r);const o={};61292&n[0]|512&n[1]&&(o.$$scope={dirty:n,ctx:e}),E.$set(o);const c={};65536&n[0]|512&n[1]&&(c.$$scope={dirty:n,ctx:e}),P.$set(c)},i(e){A||(p(t.$$.fragment,e),p(v.$$.fragment,e),p(b.$$.fragment,e),p(y.$$.fragment,e),p(E.$$.fragment,e),p(P.$$.fragment,e),A=!0)},o(e){g(t.$$.fragment,e),g(v.$$.fragment,e),g(b.$$.fragment,e),g(y.$$.fragment,e),g(E.$$.fragment,e),g(P.$$.fragment,e),A=!1},d(e){d(t,e),e&&h(n),d(v,e),e&&h(x),d(b,e),e&&h(k),d(y,e),e&&h(j),d(E,e),e&&h(z),d(P,e),I=!1,G()}}}async function fe({session:e}){let t=e.token;if(!t)return{status:302,redirect:"/login"};let n=await L("user",t);return n?{props:{user:n}}:{status:302,redirect:"/login"}}let le='Add a url scheme to the link, something like "http://, at the beginning';function me(e,t,n){let a,$,s,r,{user:o={}}=t,c={key:{}.PAYSTACK,email:o.email,metadata:{id:o.id},amount:190233,currency:"NGN",embed:!1,value:"Pay"},i=o.show_email,f=o.username,l=o.visible,m=o.address,u=o.website,p=o.image,g=o.email,d=o.phone,h=o.about,v=o.token,w=o.data,x=o.name,b=o.tags||[];const k=async()=>{if(n(16,r=!0),u&&!Y.test(u))return n(15,s=!0),void(editLoading=!1);if(!g)return void n(16,r=!1);if(!q(g))return void n(16,r=!1);if(!f)return n(13,a=!0),n(14,$="Empty"),void n(16,r=!1);if(f!==o.username&&await L(`check_username/${f}`).then((e=>!e.res)))return n(13,a=!0),n(14,$="Username taken"),void n(16,r=!1);if(q(f))return n(13,a=!0),n(14,$="Unaccepted"),void n(16,r=!1);let e={show_email:i,username:f,visible:l,website:u,address:m,email:g,phone:d,about:h,image:p,data:w,tags:b,name:x},t=await R("users",e,v).finally((e=>(n(16,r=!1),e)));t.id&&V(`/${t.username}`)};return e.$$set=e=>{"user"in e&&n(0,o=e.user)},[o,c,i,f,l,m,u,p,g,d,h,x,b,a,$,s,r,e=>{switch(e.keyCode){case 13:e.ctrlKey&&k()}},k,()=>{n(1,c.open=!0,c)},()=>{n(1,c.open=!0,c),n(1,c.amount=3e3,c),n(1,c.metadata.purpose="change_card",c)},()=>{n(1,c.open=!0,c)},function(e){p=e,n(7,p)},function(e){l=e,n(4,l)},function(e){b=e,n(12,b)},function(e){$=e,n(14,$)},function(e){a=e,n(13,a)},function(e){f=e,n(3,f)},function(e){i=e,n(2,i)},function(e){g=e,n(8,g)},function(e){x=e,n(11,x)},function(e){d=e,n(9,d)},function(e){m=e,n(5,m)},function(e){u=e,n(6,u)},function(e){h=e,n(10,h)}]}export default class extends e{constructor(e){super(),t(this,e,me,ie,n,{user:0},[-1,-1])}}export{fe as load};
