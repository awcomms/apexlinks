import{S as t,i as s,s as e,E as a,F as n,e as o,k as r,j as l,c,n as i,m as u,f as $,o as f,v as m,r as g,d as p,w as h,l as d,G as y,u as k,aa as x,a3 as b,B as j,a4 as v,t as w,a as B,g as T,b as A,ah as E,a6 as G,O as N,ad as O,h as S}from"../chunks/vendor-221a53e8.js";import{g as F}from"../chunks/api-464cac91.js";import{T as H}from"../chunks/Tag-9a4ea10c.js";import{g as J}from"../chunks/navigation-20968cc5.js";import"../chunks/singletons-bb9012b7.js";function P(t,s,e){const a=t.slice();return a[8]=s[e],a}function R(t){let s,e,a,n,r=t[8].name+"";return{c(){s=o("p"),e=w(r),this.h()},l(t){s=c(t,"P",{class:!0});var a=B(s);e=T(a,r),a.forEach(p),this.h()},h(){A(s,"class","item svelte-11iupaf"),E(s,"unseen",t[8].unseen)},m(o,r){$(o,s,r),G(s,e),a||(n=N(s,"click",(function(){O(t[2](t[8]))&&t[2](t[8]).apply(this,arguments)})),a=!0)},p(a,n){t=a,1&n&&r!==(r=t[8].name+"")&&S(e,r),1&n&&E(s,"unseen",t[8].unseen)},d(t){t&&p(s),a=!1,n()}}}function q(t){let s,e,a;return s=new v({props:{$$slots:{default:[R]},$$scope:{ctx:t}}}),{c(){l(s.$$.fragment),e=r()},l(t){u(s.$$.fragment,t),e=i(t)},m(t,n){f(s,t,n),$(t,e,n),a=!0},p(t,e){const a={};2049&e&&(a.$$scope={dirty:e,ctx:t}),s.$set(a)},i(t){a||(m(s.$$.fragment,t),a=!0)},o(t){g(s.$$.fragment,t),a=!1},d(t){h(s,t),t&&p(e)}}}function z(t){let s,e,a,n;return a=new b({props:{noGutter:!0,$$slots:{default:[q]},$$scope:{ctx:t}}}),{c(){s=o("br"),e=r(),l(a.$$.fragment)},l(t){s=c(t,"BR",{}),e=i(t),u(a.$$.fragment,t)},m(t,o){$(t,s,o),$(t,e,o),f(a,t,o),n=!0},p(t,s){const e={};2049&s&&(e.$$scope={dirty:s,ctx:t}),a.$set(e)},i(t){n||(m(a.$$.fragment,t),n=!0)},o(t){g(a.$$.fragment,t),n=!1},d(t){t&&p(s),t&&p(e),h(a,t)}}}function C(t){let s,e,o,c,b;function v(s){t[7](s)}let w={};void 0!==t[1]&&(w.tags=t[1]),s=new H({props:w}),a.push((()=>n(s,"tags",v))),s.$on("change",t[3]);let B=t[0],T=[];for(let a=0;a<B.length;a+=1)T[a]=z(P(t,B,a));const A=t=>g(T[t],1,1,(()=>{T[t]=null}));return{c(){l(s.$$.fragment),o=r();for(let t=0;t<T.length;t+=1)T[t].c();c=d()},l(t){u(s.$$.fragment,t),o=i(t);for(let s=0;s<T.length;s+=1)T[s].l(t);c=d()},m(t,e){f(s,t,e),$(t,o,e);for(let s=0;s<T.length;s+=1)T[s].m(t,e);$(t,c,e),b=!0},p(t,[a]){const n={};if(!e&&2&a&&(e=!0,n.tags=t[1],y((()=>e=!1))),s.$set(n),5&a){let s;for(B=t[0],s=0;s<B.length;s+=1){const e=P(t,B,s);T[s]?(T[s].p(e,a),m(T[s],1)):(T[s]=z(e),T[s].c(),m(T[s],1),T[s].m(c.parentNode,c))}for(j(),s=B.length;s<T.length;s+=1)A(s);k()}},i(t){if(!b){m(s.$$.fragment,t);for(let t=0;t<B.length;t+=1)m(T[t]);b=!0}},o(t){g(s.$$.fragment,t),T=T.filter(Boolean);for(let s=0;s<T.length;s+=1)g(T[s]);b=!1},d(t){h(s,t),t&&p(o),x(T,t),t&&p(c)}}}async function D({session:t}){let s;if(!t.token)return{status:302,redirect:"/login"};let{items:e,total:a,page:n}=await F("xrooms",user.token)||{};return s=Array.isArray(e)?e:[],{props:{rooms:s,total:a,page:n,user:user}}}function I(t,s,e){let a,{rooms:n}=s,{total:o}=s,{page:r}=s,{user:l}=s,c=async()=>{let t=JSON.stringify(a),s=await F(`xrooms?tags=${t}&page=${r}`,l.token);e(0,n=s.items),e(4,o=s.total)};return t.$$set=t=>{"rooms"in t&&e(0,n=t.rooms),"total"in t&&e(4,o=t.total),"page"in t&&e(5,r=t.page),"user"in t&&e(6,l=t.user)},t.$$.update=()=>{48&t.$$.dirty&&"undefined"!=typeof document&&o>100&&document.body.scrollTop==document.body.scrollHeight&&(e(5,r++,r),c())},[n,a,t=>{J(`/room/${t.id}`)},c,o,r,l,function(t){a=t,e(1,a)}]}export default class extends t{constructor(t){super(),s(this,t,I,C,e,{rooms:0,total:4,page:5,user:6})}}export{D as load};
