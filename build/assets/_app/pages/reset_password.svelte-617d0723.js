import{S as J,i as M,s as N,a1 as G,j as g,k as I,m as h,n as E,o as v,f as j,O as D,x as m,u as _,v as w,d as b,I as Q,a2 as K,ak as W,al as X,K as L,E as y,F as C,G as P,am as Y,e as R,c as S,a as T,b as Z,B as x,t as ee,g as te,af as V,ac as q,a4 as z,r as se,w as ne,p as re,U as ae}from"../chunks/vendor-cce9f310.js";import{a as O}from"../chunks/api-5c0c9630.js";import{I as U}from"../chunks/Input-93bd4be1.js";import{g as A}from"../chunks/navigation-51f4a605.js";import{n as B}from"../chunks/stores-befe408a.js";import{p as oe}from"../chunks/post-5b27026c.js";import"../chunks/singletons-12a22614.js";function le(l){let t,s,e,n,r,c,o;function a(u){l[7](u)}function d(u){l[8](u)}let $={invalidText:l[2],labelText:"Password",password:!0,focus:!0};l[3]!==void 0&&($.invalid=l[3]),l[1]!==void 0&&($.value=l[1]),t=new U({props:$}),y.push(()=>C(t,"invalid",a)),y.push(()=>C(t,"value",d));function f(u){l[9](u)}let p={labelText:"Password",password:!0};return l[0]!==void 0&&(p.value=l[0]),r=new U({props:p}),y.push(()=>C(r,"value",f)),{c(){g(t.$$.fragment),n=I(),g(r.$$.fragment)},l(u){h(t.$$.fragment,u),n=E(u),h(r.$$.fragment,u)},m(u,i){v(t,u,i),j(u,n,i),v(r,u,i),o=!0},p(u,i){const k={};i&4&&(k.invalidText=u[2]),!s&&i&8&&(s=!0,k.invalid=u[3],P(()=>s=!1)),!e&&i&2&&(e=!0,k.value=u[1],P(()=>e=!1)),t.$set(k);const F={};!c&&i&1&&(c=!0,F.value=u[0],P(()=>c=!1)),r.$set(F)},i(u){o||(m(t.$$.fragment,u),m(r.$$.fragment,u),o=!0)},o(u){_(t.$$.fragment,u),_(r.$$.fragment,u),o=!1},d(u){w(t,u),u&&b(n),w(r,u)}}}function ue(l){let t,s;return t=new W({props:{$$slots:{default:[le]},$$scope:{ctx:l}}}),{c(){g(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,n){v(t,e,n),s=!0},p(e,n){const r={};n&4111&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(m(t.$$.fragment,e),s=!0)},o(e){_(t.$$.fragment,e),s=!1},d(e){w(t,e)}}}function ie(l){let t,s;return t=new K({props:{$$slots:{default:[ue]},$$scope:{ctx:l}}}),{c(){g(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,n){v(t,e,n),s=!0},p(e,n){const r={};n&4111&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(m(t.$$.fragment,e),s=!0)},o(e){_(t.$$.fragment,e),s=!1},d(e){w(t,e)}}}function H(l){let t,s,e;return s=new ae({}),{c(){t=R("div"),g(s.$$.fragment),this.h()},l(n){t=S(n,"DIV",{class:!0});var r=T(t);h(s.$$.fragment,r),r.forEach(b),this.h()},h(){Z(t,"class","right svelte-pb9zr2")},m(n,r){j(n,t,r),v(s,t,null),e=!0},i(n){e||(m(s.$$.fragment,n),e=!0)},o(n){_(s.$$.fragment,n),e=!1},d(n){n&&b(t),w(s)}}}function fe(l){let t,s,e,n,r,c,o,a=l[4]&&H(),d=[l[11]],$={};for(let f=0;f<d.length;f+=1)$=x($,d[f]);return{c(){t=R("div"),s=R("p"),e=ee("Reset"),n=I(),a&&a.c(),this.h()},l(f){t=S(f,"DIV",{});var p=T(t);s=S(p,"P",{});var u=T(s);e=te(u,"Reset"),u.forEach(b),n=E(p),a&&a.l(p),p.forEach(b),this.h()},h(){V(t,$),q(t,"svelte-pb9zr2",!0)},m(f,p){j(f,t,p),z(t,s),z(s,e),z(t,n),a&&a.m(t,null),r=!0,c||(o=D(t,"click",l[6]),c=!0)},p(f,p){f[4]?a?p&16&&m(a,1):(a=H(),a.c(),m(a,1),a.m(t,null)):a&&(se(),_(a,1,1,()=>{a=null}),ne()),V(t,$=re(d,[p&2048&&f[11]])),q(t,"svelte-pb9zr2",!0)},i(f){r||(m(a),r=!0)},o(f){_(a),r=!1},d(f){f&&b(t),a&&a.d(),c=!1,o()}}}function ce(l){let t,s;return t=new Y({props:{as:!0,$$slots:{default:[fe,({props:e})=>({11:e}),({props:e})=>e?2048:0]},$$scope:{ctx:l}}}),{c(){g(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,n){v(t,e,n),s=!0},p(e,n){const r={};n&6160&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(m(t.$$.fragment,e),s=!0)},o(e){_(t.$$.fragment,e),s=!1},d(e){w(t,e)}}}function pe(l){let t,s;return t=new X({props:{stacked:!0,$$slots:{default:[ce]},$$scope:{ctx:l}}}),{c(){g(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,n){v(t,e,n),s=!0},p(e,n){const r={};n&4112&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(m(t.$$.fragment,e),s=!0)},o(e){_(t.$$.fragment,e),s=!1},d(e){w(t,e)}}}function $e(l){let t,s;return t=new K({props:{$$slots:{default:[pe]},$$scope:{ctx:l}}}),{c(){g(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,n){v(t,e,n),s=!0},p(e,n){const r={};n&4112&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(m(t.$$.fragment,e),s=!0)},o(e){_(t.$$.fragment,e),s=!1},d(e){w(t,e)}}}function me(l){let t,s,e,n,r,c;return t=new G({props:{noGutter:!0,$$slots:{default:[ie]},$$scope:{ctx:l}}}),e=new G({props:{noGutter:!0,$$slots:{default:[$e]},$$scope:{ctx:l}}}),{c(){g(t.$$.fragment),s=I(),g(e.$$.fragment)},l(o){h(t.$$.fragment,o),s=E(o),h(e.$$.fragment,o)},m(o,a){v(t,o,a),j(o,s,a),v(e,o,a),n=!0,r||(c=D(window,"keydown",l[5]),r=!0)},p(o,[a]){const d={};a&4111&&(d.$$scope={dirty:a,ctx:o}),t.$set(d);const $={};a&4112&&($.$$scope={dirty:a,ctx:o}),e.$set($)},i(o){n||(m(t.$$.fragment,o),m(e.$$.fragment,o),n=!0)},o(o){_(t.$$.fragment,o),_(e.$$.fragment,o),n=!1},d(o){w(t,o),o&&b(s),w(e,o),r=!1,c()}}}async function je(){if(!(await O.get("check_reset_password_token")).r)return{status:302,redirect:"login?n=invalid"}}function _e(l,t,s){let e;Q(l,B,i=>s(10,e=i));let n,r,c,o,a;const d=i=>{if(i.ctrlKey)switch(i.keyCode){case 13:join()}else switch(i.keyCode){case 13:login()}};let $=async()=>{if(s(4,a=!0),!r){s(3,o=!0),s(2,c="Empty"),s(4,a=!1);return}if(r!==n){s(3,o=!0),s(2,c="Passwords do not match"),s(4,a=!1);return}(await O.put("reset_password",{password:n}).finally(k=>(s(4,a=!1),k))).r?(L(B,e="resetSuccess",e),await oe("auth/login",{username,password:n}),A("/")):(L(B,e="invalidLink",e),A("/login"))};function f(i){o=i,s(3,o)}function p(i){r=i,s(1,r)}function u(i){n=i,s(0,n)}return[n,r,c,o,a,d,$,f,p,u]}class Ie extends J{constructor(t){super();M(this,t,_e,me,N,{})}}export{Ie as default,je as load};
