import{S as t,i as s,s as e,E as a,F as n,e as o,k as r,j as c,c as l,n as i,m as u,f as $,o as f,v as m,r as p,d as g,w as h,l as d,G as y,u as b,a6 as x,a1 as k,B as j,a2 as v,t as w,a as B,g as T,b as A,ac as E,a4 as G,O as N,a8 as O,h as S}from"../chunks/vendor-83a11e53.js";import{a as F}from"../chunks/api-5c0c9630.js";import{T as H}from"../chunks/Tag-875b6479.js";import{g as J}from"../chunks/navigation-20968cc5.js";import"../chunks/post-5b27026c.js";import"../chunks/singletons-bb9012b7.js";function P(t,s,e){const a=t.slice();return a[8]=s[e],a}function R(t){let s,e,a,n,r=t[8].name+"";return{c(){s=o("p"),e=w(r),this.h()},l(t){s=l(t,"P",{class:!0});var a=B(s);e=T(a,r),a.forEach(g),this.h()},h(){A(s,"class","item svelte-11iupaf"),E(s,"unseen",t[8].unseen)},m(o,r){$(o,s,r),G(s,e),a||(n=N(s,"click",(function(){O(t[2](t[8]))&&t[2](t[8]).apply(this,arguments)})),a=!0)},p(a,n){t=a,1&n&&r!==(r=t[8].name+"")&&S(e,r),1&n&&E(s,"unseen",t[8].unseen)},d(t){t&&g(s),a=!1,n()}}}function q(t){let s,e,a;return s=new v({props:{$$slots:{default:[R]},$$scope:{ctx:t}}}),{c(){c(s.$$.fragment),e=r()},l(t){u(s.$$.fragment,t),e=i(t)},m(t,n){f(s,t,n),$(t,e,n),a=!0},p(t,e){const a={};2049&e&&(a.$$scope={dirty:e,ctx:t}),s.$set(a)},i(t){a||(m(s.$$.fragment,t),a=!0)},o(t){p(s.$$.fragment,t),a=!1},d(t){h(s,t),t&&g(e)}}}function z(t){let s,e,a,n;return a=new k({props:{noGutter:!0,$$slots:{default:[q]},$$scope:{ctx:t}}}),{c(){s=o("br"),e=r(),c(a.$$.fragment)},l(t){s=l(t,"BR",{}),e=i(t),u(a.$$.fragment,t)},m(t,o){$(t,s,o),$(t,e,o),f(a,t,o),n=!0},p(t,s){const e={};2049&s&&(e.$$scope={dirty:s,ctx:t}),a.$set(e)},i(t){n||(m(a.$$.fragment,t),n=!0)},o(t){p(a.$$.fragment,t),n=!1},d(t){t&&g(s),t&&g(e),h(a,t)}}}function C(t){let s,e,o,l,k;function v(s){t[7](s)}let w={};void 0!==t[1]&&(w.tags=t[1]),s=new H({props:w}),a.push((()=>n(s,"tags",v))),s.$on("change",t[3]);let B=t[0],T=[];for(let a=0;a<B.length;a+=1)T[a]=z(P(t,B,a));const A=t=>p(T[t],1,1,(()=>{T[t]=null}));return{c(){c(s.$$.fragment),o=r();for(let t=0;t<T.length;t+=1)T[t].c();l=d()},l(t){u(s.$$.fragment,t),o=i(t);for(let s=0;s<T.length;s+=1)T[s].l(t);l=d()},m(t,e){f(s,t,e),$(t,o,e);for(let s=0;s<T.length;s+=1)T[s].m(t,e);$(t,l,e),k=!0},p(t,[a]){const n={};if(!e&&2&a&&(e=!0,n.tags=t[1],y((()=>e=!1))),s.$set(n),5&a){let s;for(B=t[0],s=0;s<B.length;s+=1){const e=P(t,B,s);T[s]?(T[s].p(e,a),m(T[s],1)):(T[s]=z(e),T[s].c(),m(T[s],1),T[s].m(l.parentNode,l))}for(j(),s=B.length;s<T.length;s+=1)A(s);b()}},i(t){if(!k){m(s.$$.fragment,t);for(let t=0;t<B.length;t+=1)m(T[t]);k=!0}},o(t){p(s.$$.fragment,t),T=T.filter(Boolean);for(let s=0;s<T.length;s+=1)p(T[s]);k=!1},d(t){h(s,t),t&&g(o),x(T,t),t&&g(l)}}}async function D({session:t}){let s,e=t.user;if(!e)return{status:302,redirect:"/login"};let{items:a,total:n,page:o}=await F.get("xrooms")||{};return s=Array.isArray(a)?a:[],{props:{rooms:s,total:n,page:o,user:e}}}function I(t,s,e){let a,{rooms:n}=s,{total:o}=s,{page:r}=s,{user:c}=s,l=async()=>{let t=JSON.stringify(a),s=await F.get(`xrooms?tags=${t}&page=${r}`);e(0,n=s.items),e(4,o=s.total)};return t.$$set=t=>{"rooms"in t&&e(0,n=t.rooms),"total"in t&&e(4,o=t.total),"page"in t&&e(5,r=t.page),"user"in t&&e(6,c=t.user)},t.$$.update=()=>{48&t.$$.dirty&&"undefined"!=typeof document&&o>100&&document.body.scrollTop==document.body.scrollHeight&&(e(5,r++,r),l())},[n,a,t=>{J(`/room/${t.id}`)},l,o,r,c,function(t){a=t,e(1,a)}]}export default class extends t{constructor(t){super(),s(this,t,I,C,e,{rooms:0,total:4,page:5,user:6})}}export{D as load};
