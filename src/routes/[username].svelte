<script context='module'>
    import * as api from '$lib/api'
    export async function load({page}){
        let {username} = page.params
        let user = await api.get(`users/${username}`)
        if (user.error){
            return {
                status: user.status,
                error: user.error
            }
        }
        return {
            props: {
                user
            }
        }
    }
</script>

<script>
    export let user
    import {
        Column,
        Link,
        Row
    } from 'carbon-components-svelte'
    import User20 from 'carbon-icons-svelte/lib/User20'
    import Phone20 from 'carbon-icons-svelte/lib/Phone20'
    import Earth20 from 'carbon-icons-svelte/lib/Earth20'
    import Email20 from 'carbon-icons-svelte/lib/Email20'
    import Location20 from 'carbon-icons-svelte/lib/Location20'
    import { session } from '$app/stores'
    import {parseMarkdown} from '$lib/utils'

    let about
    if (user.about) about = parseMarkdown(user.about)
</script>

<Row>
    {#if user.image}
        <Column lg={2} sm={2} md={2} xlg={2}>
            <img style='width: 100%;' alt='user display _image' src={user.image}>
        </Column>
    {/if}
    <Column lg={4} sm={4} md={4} xlg={4}>
        {#if user.name}
            <p style='font-weight: 600;'>{user.name}</p>
        {/if}
        {#if user.username}
            <div>
                <User20 />
                <span class='heading'>{user.username}</span>
            </div>
        {/if}
        {#if user.address}
            <div>
                <Location20 />
                <span class='heading'>{user.address}</span>
            </div>
        {/if}
        {#if user.show_email && user.email}
            <div>
                <Email20 />
                <span class='heading'>{user.email}</span>
            </div>
        {/if}
        {#if user.website}
            <div>
                <Earth20 />
                <a class='heading bx--link' href={user.website}>{user.website}</a>
            </div>
        {/if}
        {#if user.phone}
            <div>
                <Phone20 />
                <span class='heading'>{user.phone}</span>
            </div>
        {/if}
        <br />
        <!-- {#if } -->
            <Link href='/items/{user.id}'>Items</Link>
        <!-- {/if} -->
    </Column>
</Row>

<br />

<Row>
    <Column lg={6} sm={6} md={6} xlg={6}>
        {#if about}
            <p>{@html about}</p>
        {/if}
    </Column>
</Row>

<style>
    
</style>